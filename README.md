# DoH_Malware_Test

Muchos servicios de DNS over HTTPS realizan una validación sobre el dominio en las listas negras de malware. Este script aprovecha esa caracterstica de este servicio para hacer una consulta de DoH a varios servidores y comparar su respuesta sobre si esta o no reportado en la lista negra de cada uno de estos servicios.


# Prerequisitos

El único paquete que se debe instalar de forma adiciona es requests, lo cual se puede hacer así
```bash
pip install requests
```

# Funcionamiento

Una vez clonado y asegurado el prerequisito se puede ejecuta adicionando el domino que se va a analizar, así

```bash
python3 DoH_test.py dominio.com
```

# Respuesta

El proceso en la consola genera un resumen donde se muestra la valoración de cada uno de los servidores consultados, así
```bash
[*] ----------------------------------------------------------------------------------- [*]
[*] We analized the DoH response of example.com
[*] ----------------------------------------------------------------------------------- [*]

[*]	DNS Server		Classification
[*]	elevenpaths		Good
[*]	google		    Good
[*]	cloudflare		Good
[*]	nextdns		    Good
[*] ----------------------------------------------------------------------------------- [*]
```

Y genera un json con datos adicionales de cada una de las respuestas, así
```bash
{
  "elevenpaths": {
    "report_DoH": "Good", 
    "domain": "example.com", 
    "A": [["93.184.216.34"]]
  }, 
  "google": {
    "report_DoH": "Good", 
    "domain": "example.com", 
    "A": [["93.184.216.34"]]
  }, 
  "cloudflare": {
    "report_DoH": "Good", 
    "domain": "example.com", 
    "A": [["93.184.216.34"]]
  }, 
  "nextdns": {
    "report_DoH": "Good", 
    "domain": "example.com", 
    "A": [["93.184.216.34"]]
  }, 
  "controld": {
    "report_DoH": "Good", 
    "domain": "example.com", 
    "A": [["93.184.216.34"]]}}
```
